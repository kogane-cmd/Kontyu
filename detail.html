<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>作品詳細</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const params = new URLSearchParams(location.search);
    const id = params.get("id");

    async function loadDetail() {
      const docRef = doc(db, "insects", id);
      const snap = await getDoc(docRef);
      if (!snap.exists()) {
        document.body.innerHTML = "<p>作品が見つかりません。</p>";
        return;
      }
      const data = snap.data();

      document.getElementById("title").textContent = data.name;
      document.getElementById("user").textContent = data.user;
      document.getElementById("userId").textContent = data.userId;
      document.getElementById("description").textContent = data.description;
      document.getElementById("lastUpdated").textContent =
        data.lastUpdated?.toDate().toLocaleString("ja-JP") || "";

      if (data.imageUrl) {
        document.getElementById("image").src = data.imageUrl;
      }
    }

    window.addEventListener("DOMContentLoaded", loadDetail);
  </script>
</head>
<body>
  <h2 id="title"></h2>
  <p>作成者: <span id="user"></span> (ID: <span id="userId"></span>)</p>
  <img id="image" alt="作品画像" style="max-width:300px; display:block;"><br>
  <p id="description"></p>
  <p>最終更新日: <span id="lastUpdated"></span></p>
  <p><a href="list.html">← リストに戻る</a></p>
</body>
</html>
